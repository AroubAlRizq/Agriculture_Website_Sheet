<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCM Agricultural Calculator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <div class="app">
        <header class="topbar">
            <div class="brand">
                <div class="logo-circle">N</div>
                <div class="brand-text">
                    <h1>Agriculture Indices Calculator</h1>
                    <p>National Center of Meteorology</p>
                </div>
            </div>
            <div style="padding: 0.5rem 1rem; background: rgba(255,255,255,0.05); border-radius: 99px; border: 1px solid rgba(255,255,255,0.1); font-size: 0.85rem; color: var(--cyan-accent);">
                Batch Excel Processing
            </div>
        </header>

        <div class="glass-card">
            
            <div class="form-group">
                <label for="formula-select">1. Select Computation Model</label>
                <div class="select-wrapper">
                    <select id="formula-select">
                        <option value="" disabled selected>-- Choose a Method --</option>
                        
                        <optgroup label="Vegetation Indices">
                            <option value="ndvi">NDVI</option>
                            <option value="gndvi">GNDVI</option>
                            <option value="pri">PRI</option>
                            <option value="ndre">NDRE</option>
                            <option value="ccci">CCCI</option>
                            <option value="rvi">RVI</option>
                            <option value="evi">EVI</option>
                            <option value="evi2">EVI 2</option>
                            <option value="varigreen">VARIgreen</option>
                            <option value="vari700">VARI700</option>
                            <option value="tvi">TVI</option>
                            <option value="mtvi1">MTVI 1</option>
                            <option value="mtvi2">MTVI 2</option>
                            <option value="mtci">MTCI</option>
                            <option value="car">CAR</option>
                            <option value="cari">CARI</option>
                            <option value="mcari">MCARI</option>
                            <option value="mcari1">MCARI 1</option>
                            <option value="mcari2">MCARI 2</option>
                            <option value="tcari">TCARI</option>
                            <option value="wdvi">WDVI</option>
                            <option value="pvi">PVI</option>
                            <option value="savi">SAVI</option>
                            <option value="tsavi">TSAVI</option>
                            <option value="osavi">OSAVI</option>
                            <option value="msavi">MSAVI</option>
                            <option value="msavi2">MSAVI2</option>
                            <option value="sarvi">SARVI</option>
                        </optgroup>

                        <optgroup label="Growing Degree Days (GDD)">
                            <option value="gdd_arnold">Arnold</option>
                            <option value="gdd_villa_nova">Villa-Nova</option>
                            <option value="gdd_ometto">Ometto</option>
                            <option value="gdd_snyder">Snyder</option>
                        </optgroup>

                        <optgroup label="Accumulation Chilling Units">
                            <option value="chill_utah">Utah Model</option>
                            <option value="chill_nc">North Carolina Model</option>
                        </optgroup>

                        <optgroup label="Evapotranspiration (ET)">
                            <option value="fao56">FAO56 (Penman-Monteith)</option>
                            <option value="hargreaves">Hargreaves</option>
                            <option value="blaney_criddle">Blaney-Criddle</option>
                            <option value="stephens_stewart">Stephens & Stewart</option>
                            <option value="grassi">Grassi</option>
                            <option value="linarce">Linarce</option>
                        </optgroup>
                    </select>
                </div>
            </div>

            <div class="form-group" style="margin-top: 2rem;">
                <label for="excel-file">2. Upload Excel Data Sheet (.xlsx)</label>
                <div class="file-upload-wrapper">
                    <input type="file" id="excel-file" accept=".xlsx, .xls">
                    <p class="hint-text">Ensure your Excel columns match variable names (e.g., "NIR", "Red", "T_max")</p>
                </div>
            </div>

            <button id="calc-btn">Process & Download Results</button>
            <div id="loading-msg" class="hidden">Processing... Please wait.</div>

        </div>

        <footer>
            <p>Calculations based on FAO standards & Scientific literature.</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
